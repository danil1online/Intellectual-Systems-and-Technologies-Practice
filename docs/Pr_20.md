
# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ20 –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ. –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤

---

## üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã.

–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞–Ω–∏—è –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∏–Ω—ã—Ö –≤–∏–¥–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π —Ç–∏–ø–∞ Transformer

## üìö –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞–±–æ—Ç–µ

  - –í–∞—Ä–∏–∞–Ω—Ç 1. –ò–∑—É—á–∏—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∫–æ–Ω—Å–ø–µ–∫—Ç–æ–≤ –ª–µ–∫—Ü–∏–π –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - –í–∞—Ä–∏–∞–Ω—Ç 2. –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –∏–∑ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: [—Å—Å—ã–ª–∫–∞ 1](https://huggingface.co/learn/llm-course/ru/chapter1/3), [—Å—Å—ã–ª–∫–∞ 2](https://habr.com/ru/companies/wunderfund/articles/593713/) –∏ —Ç.–¥.

---

## üìÅ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –º–µ—Ç–æ–¥—ã

- –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ - [Ubuntu 22.04](https://help.ubuntu.ru/wiki/–∫–æ–º–∞–Ω–¥–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞)
- –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äì [python](https://www.python.org/).
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
  -  [jupyter Notebook](https://jupyter.org/).
- –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
  - [matplotlib](https://matplotlib.org/)
  - [numpy](https://numpy.org/)
  - [PyTorch](https://pytorch.org/get-started/locally/)
  - [transformers](https://huggingface.co/docs/transformers/index)
  - [datasets](https://huggingface.co/docs/datasets/index)

---

## üß™ –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç—ã 

---

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–µ–¥—ã  

**–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ [Jupyter-Hub](https://jupyter.org/hub) –ø–æ –∞–¥—Ä–µ—Å—É [Jupyter-Hub-–ò–ò–°–¢-–ù–ü–ò](http://89.110.116.79:7998/)**

**–° –ø–æ–º–æ—â—å—é —Ñ–∞–π–ª–æ–≤–æ–≥–æ –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å–ª–µ–≤–∞ –ø–µ—Ä–µ–π—Ç–∏ –≤ —Å–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥ (–§–ò–û –∏ –≥–æ–¥), —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ (–¥–≤–æ–π–Ω—ã–º –Ω–∞–∂–∞—Ç–∏–µ–º –º—ã—à–∏)**

**–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É —Å–∏–º–≤–æ–ª–æ–º +**

**–í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏ -- Notebook**

**–°–æ—Ö—Ä–∞–Ω–∏—Ç—å / –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª**

**–†–∞–±–æ—Ç–∞—Ç—å –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ –≤–∏–¥–∞**

![–í–ª–∞–¥–∫–∞ Notebook](../images/notebook_clear_window.png)

**–ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫**

```python
from datasets import load_dataset
from transformers import pipeline
import pandas as pd
from pathlib import Path
import time
cache_path_str = "/home/jupyter/work/cache_huggingface"
cache_path = Path(cache_path_str)
from IPython.display import HTML, display
```

---

### üß™ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤

  1. üß™ –°—É–º–º–∞—Ä–∏–∑–∞—Ü–∏—è

–ó–∞–¥–∞—á–∞ —Å—É–º–º–∞—Ä–∏–∑–∞—Ü–∏–∏ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –¥–≤–µ —Ñ–æ—Ä–º—ã:

  - extractive - –≤—ã–±–æ—Ä —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ç—Ä—ã–≤–∫–æ–≤ –∏–∑ —Ç–µ–∫—Å—Ç–∞
  - abstractive - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—Ñ–µ—Ä–∞—Ç–æ–≤ –Ω–æ–≤—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Ñ–µ—Ä–∞—Ç–∞ –ø–æ –æ–±—â–µ–º—É —Å–º—ã—Å–ª—É. 

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è: –Ω–∞ [—Å—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞–¥–∞–Ω–∏—è –ø–æ —Ä–µ—Ñ–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏—é Hugging Face]((https://huggingface.co/docs/transformers/tasks/summarization)) –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –º–æ–¥–µ–ª–µ–π, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ —Ä–µ—Ñ–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ. 

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
  - –î–∞–Ω–Ω—ã–µ : –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö [xsum]((https://huggingface.co/datasets/xsum)), —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –Ω–∞–±–æ—Ä —Å—Ç–∞—Ç–µ–π –∏ —Ä–µ–∑—é–º–µ BBC.
  - –ú–æ–¥–µ–ª—å : [t5-small]((https://huggingface.co/t5-small)), —Å–æ–¥–µ—Ä–∂–∞—â–∞—è 60 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (242 –ú–ë –¥–ª—è PyTorch). T5 ‚Äî —ç—Ç–æ –º–æ–¥–µ–ª—å –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∞-–¥–µ–∫–æ–¥–µ—Ä–∞, —Å–æ–∑–¥–∞–Ω–Ω–∞—è Google, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä—è–¥ –∑–∞–¥–∞—á, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ä–µ—Ñ–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–µ—Ä–µ–≤–æ–¥, –≤–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. –≤ [–±–ª–æ–≥–µ Google](https://ai.googleblog.com/2020/02/exploring-transfer-learning-with-t5.html), [–∫–æ–¥–µ –Ω–∞ GitHub](https://github.com/google-research/text-to-text-transfer-transformer) –∏–ª–∏ –≤ [–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Å—Ç–∞—Ç—å–µ](https://arxiv.org/pdf/1910.10683.pdf).

–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
```python
xsum_dataset = load_dataset(
    "xsum", version="1.2.0", cache_dir=cache_path
)  # Note: We specify cache_dir to use predownloaded data.
xsum_dataset  
```

–≠—Ç–æ—Ç –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å–æ–¥–µ—Ä–∂–∏—Ç 3 —Å—Ç–æ–ª–±—Ü–∞:
  - document: —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏ BBC
  - summary: —Ä–µ–∑—é–º–µ, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞ ¬´–ø—Ä–∏–∑–µ–º–ª—ë–Ω–Ω–æ–π –∏—Å—Ç–∏–Ω–µ¬ª --> –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ —ç—Ç–æ —Ä–µ–∑—é–º–µ. –≠—Ç–æ –æ—Ç–ª–∏—á–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, —á—Ç–æ –≤–æ –º–Ω–æ–≥–∏—Ö –∑–∞—è–≤–ª–µ–Ω–∏—è—Ö –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–∏ –º–∞–≥–∏—Å—Ç—Ä–∞ –ø—Ä–∞–≤–∞ –Ω–µ—Ç –æ—á–µ–≤–∏–¥–Ω—ã—Ö ¬´–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö¬ª –æ—Ç–≤–µ—Ç–æ–≤.
  - id: –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—å–∏

–í—ã–¥–µ–ª–∏–º 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–∞—Ç–∞—Å–µ—Ç–∞:
```python
xsum_sample = xsum_dataset["train"].select(range(10))
display(xsum_sample.to_pandas())
```

–î–∞–ª–µ–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç Hugging Face pipeline –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏. –í —ç—Ç–æ–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –∫–æ–Ω–≤–µ–π–µ—Ä–∞ LLM –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º:

  - task: –≠—Ç–æ—Ç –ø–µ—Ä–≤—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –∑–∞–¥–∞—á—É. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. –≤ —Ä–∞–∑–¥–µ–ª–µ [–ó–∞–¥–∞—á–∏ Hugging Face](https://huggingface.co/tasks)
  - model: –≠—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏–∑ [Hugging Face Hub](https://huggingface.co/models)
  - min_length, max_length: –ú—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞–º–∏ —Å–≤–æ–¥–∫–∏ –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è –¥–ª–∏–Ω–∞–º–∏ —Ç–æ–∫–µ–Ω–æ–≤
  - truncation: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–º–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ LLM. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ LLM –∏–º–µ—é—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –¥–ª–∏–Ω—É –≤—Ö–æ–¥–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π. –≠—Ç–∞ –æ–ø—Ü–∏—è —É–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω–≤–µ–π–µ—Ä—É –æ–±—Ä–µ–∑–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

```python
summarizer = pipeline(
    task="summarization",
    model="t5-small",
    min_length=20,
    max_length=40,
    truncation=True,
    device = -1,
    model_kwargs={"cache_dir": cache_path},
)
```

–û–±—Ä–∞–±–æ—Ç–∞–µ–º –æ–¥–Ω—É —Å—Ç–∞—Ç—å—é —Å–≤–æ–µ–π –º–æ–¥–µ–ª—å—é:
```python
summarizer(xsum_sample["document"][0])
```

–û–±—Ä–∞–±–æ—Ç–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–∞—Ç–µ–π —Å–≤–æ–µ–π –º–æ–¥–µ–ª—å—é:
```python
results = summarizer(xsum_sample["document"])
```

–û—Ç—Ä–∞–∑–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
```python
display(
    pd.DataFrame.from_dict(results)
    .rename({"summary_text": "generated_summary"}, axis=1)
    .join(pd.DataFrame.from_dict(xsum_sample))[
        ["generated_summary", "summary", "document"]
    ]
)
```

  2. üß™ –ê–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
‚Äî —ç—Ç–æ –∑–∞–¥–∞—á–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–∞, –∑–∞–∫–ª—é—á–∞—é—â–∞—è—Å—è –≤ –æ—Ü–µ–Ω–∫–µ —Ç–æ–≥–æ, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Ç–µ–∫—Å—Ç–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º –∏–ª–∏ –∏–º–µ–µ—Ç –¥—Ä—É–≥—É—é —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å. –¢–æ—á–Ω—ã–π –Ω–∞–±–æ—Ä –º–µ—Ç–æ–∫ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –º–æ–∂–µ—Ç —Ä–∞–∑–ª–∏—á–∞—Ç—å—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö.

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è : —Å–º. [—Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–¥–∞—á–∏ ¬´–û–±–Ω–∏–º–∞—é—â–µ–µ –ª–∏—Ü–æ¬ª]((https://huggingface.co/tasks/text-classification)) –æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤ –∏–ª–∏ [–í–∏–∫–∏–ø–µ–¥–∏—é –æ–± –∞–Ω–∞–ª–∏–∑–µ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏](https://en.wikipedia.org/wiki/Sentiment_analysis). 

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

  - –î–∞–Ω–Ω—ã–µ : [–Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è—Ö —Å—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏–π](https://huggingface.co/datasets/poem_sentiment), —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Å—Ç—Ä–æ–∫–∏ –∏–∑ —Å—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏–π, –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è–º–∏ negative(0), positive(1), no_impact(2) –∏–ª–∏ mixed(3).
  - –ú–æ–¥–µ–ª—å : [—É—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è BERT](https://huggingface.co/nickwong64/bert-base-uncased-poems-sentiment). BERT (Bidirection Encoder Representations from Transformers) ‚Äî —ç—Ç–æ –º–æ–¥–µ–ª—å, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è Google –∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∑–∞–¥–∞—á —É—Ä–æ–≤–Ω—è 11+, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∞–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞ –∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [—ç—Ç—É](https://huggingface.co/blog/bert-101) –∑–∞–ø–∏—Å—å –≤ –±–ª–æ–≥–µ Hugging Face –∏–ª–∏ –Ω–∞ [—Å—Ç—Ä–∞–Ω–∏—Ü–µ](https://en.wikipedia.org/wiki/BERT_&#40;language_model&#41;) –≤ –í–∏–∫–∏–ø–µ–¥–∏–∏.

–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
```python
poem_dataset = load_dataset(
    "poem_sentiment", 
    #version="1.0.0", 
    cache_dir=cache_path
)
poem_sample = poem_dataset["train"].select(range(10))
display(poem_sample.to_pandas())
```

–û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∞–ø–ª–∞–π–Ω –æ–±—Ä–∞–±–æ—Ç–∫–∏
```python
sentiment_classifier = pipeline(
    task="text-classification",
    model="nickwong64/bert-base-uncased-poems-sentiment",
    device = -1,
    model_kwargs={"cache_dir": cache_path},
)
```

–û–±—Ä–∞–±–æ—Ç–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏–π —Å–≤–æ–µ–π –º–æ–¥–µ–ª—å—é:
```python
results = sentiment_classifier(poem_sample["verse_text"])
```

–û—Ç—Ä–∞–∑–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
```python
joined_data = (
    pd.DataFrame.from_dict(results)
    .rename({"label": "predicted_label"}, axis=1)
    .join(pd.DataFrame.from_dict(poem_sample).rename({"label": "true_label"}, axis=1))
)

# Change label indices to text labels
sentiment_labels = {0: "negative", 1: "positive", 2: "no_impact", 3: "mixed"}
joined_data = joined_data.replace({"true_label": sentiment_labels})

display(joined_data[["predicted_label", "true_label", "score", "verse_text"]])
```
  3. üß™ –ü—Ä–æ–º–ø—Ç-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥. Few-shot learning

–ï—Å–ª–∏ –º—ã –æ–ø–∏—Ä–∞–µ–º—Å—è –Ω–∞ **—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏** –º–æ–¥–µ–ª–∏, –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–æ–¥—Ö–æ–¥–æ–º, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ü—Ä–æ–º–ø—Ç-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥. –û–¥–Ω–∏–º –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —è–≤–ª—è–µ—Ç—Å—è Few-shot learning, –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã –¥–∞—ë—Ç–µ –º–æ–¥–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é, –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤, –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—â–∏—Ö, –∫–∞–∫ —Å–ª–µ–¥–æ–≤–∞—Ç—å —ç—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∞ –∑–∞—Ç–µ–º –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å. –ú–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ —ç—Ç–æ—Ç –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å. 

–£ —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ –µ—Å—Ç—å —Å–≤–æ–∏ –ø–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã: –æ–Ω –æ—á–µ–Ω—å –º–æ—â–Ω—ã–π –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥—Ä—É–≥–∏—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω—ã–º –∏ —Ç—Ä–µ–±–æ–≤–∞—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –¥–æ—Ä–∞–±–æ—Ç–æ–∫ –≤—Ö–æ–¥–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ö–æ—Ä–æ—à–∏—Ö –∏ –Ω–∞–¥—ë–∂–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. 

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è : —Å–º. [—Å—Ç—Ä–∞–Ω–∏—Ü—É](https://en.wikipedia.org/wiki/Few-shot_learning_&#40;natural_language_processing&#41;) –í–∏–∫–∏–ø–µ–¥–∏–∏ –æ –æ–±—É—á–µ–Ω–∏–∏ —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ø—ã—Ç–æ–∫ –∏–ª–∏ [—ç—Ç–æ—Ç –±–ª–æ–≥](https://huggingface.co/blog/few-shot-learning-gpt-neo-and-inference-api) Hugging Face –æ –æ–±—É—á–µ–Ω–∏–∏ —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ø—ã—Ç–æ–∫. 

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ:

  - –ó–∞–¥–∞—á–∞ : –æ–±—É—á–µ–Ω–∏–µ —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ø—ã—Ç–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–æ –∫–æ –º–Ω–æ–≥–∏–º –∑–∞–¥–∞—á–∞–º. –ó–¥–µ—Å—å –º—ã –ø—Ä–æ–≤–µ–¥—ë–º –∞–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏, –æ –∫–æ—Ç–æ—Ä–æ–º –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏ —Ä–∞–Ω–µ–µ. –û–¥–Ω–∞–∫–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ, –∫–∞–∫ –æ–±—É—á–µ–Ω–∏–µ —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –∑–∞–¥–∞–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–µ—Ç–∫–∏, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –ø—Ä–µ–¥—ã–¥—É—â–∞—è –º–æ–¥–µ–ª—å –±—ã–ª–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –º–µ—Ç–æ–∫. –í –∫–æ–Ω—Ü–µ –º—ã —Ç–∞–∫–∂–µ –ø–æ–∫–∞–∂–µ–º –¥—Ä—É–≥–∏–µ (–∏–≥—Ä—É—à–µ—á–Ω—ã–µ) –∑–∞–¥–∞—á–∏. –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –æ–±–Ω–∏–º–∞—é—â–µ–≥–æ –ª–∏—Ü–∞, task—É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ pipeline –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ, –æ–±—É—á–µ–Ω–∏–µ —Å –º–∞–ª—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–ø—ã—Ç–æ–∫ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ text-generation –∑–∞–¥–∞—á–∞.
  - –î–∞–Ω–Ω—ã–µ : –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤, –≤–∫–ª—é—á–∞—è –ø—Ä–∏–º–µ—Ä —Ç–≤–∏—Ç–∞ –∏–∑ –∑–∞–ø–∏—Å–∏ –≤ –±–ª–æ–≥–µ.
  - –ú–æ–¥–µ–ª—å : [gpt-neo-1.3B](https://huggingface.co/EleutherAI/gpt-neo-1.3B) , –≤–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏ GPT-Neo. –≠—Ç–æ –º–æ–¥–µ–ª—å-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä —Å 1,3 –º–∏–ª–ª–∏–∞—Ä–¥–∞–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è Eleuther AI. –ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. [–∫–æ–¥](https://github.com/EleutherAI/gpt-neo) –Ω–∞ GitHub –∏–ª–∏ –≤ [–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π —Å—Ç–∞—Ç—å–µ](https://arxiv.org/abs/2204.06745).

–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏
```python
few_shot_pipeline = pipeline(
    task="text-generation",
    model="EleutherAI/gpt-neo-1.3B",
    max_new_tokens=10,
    device = -1,
    model_kwargs={"cache_dir": cache_path},
)
eos_token_id = few_shot_pipeline.tokenizer.encode("###")[0]
```
  - –ü—Ä–∏–º–µ—Ä 1.
```python
results = few_shot_pipeline(
    """For each tweet, describe its sentiment:

[Tweet]: "This new music video was incredible"
[Sentiment]:""",
    eos_token_id=eos_token_id,
)

print(results[0]["generated_text"])
```
  - –ü—Ä–∏–º–µ—Ä 2.
```python
results = few_shot_pipeline(
    """For each tweet, describe its sentiment:

[Tweet]: "This is the link to the article"
[Sentiment]: Neutral
###
[Tweet]: "This new music video was incredible"
[Sentiment]:""",
    eos_token_id=eos_token_id,
)

print(results[0]["generated_text"])
```
  - –ü—Ä–∏–º–µ—Ä 3.
```python
results = few_shot_pipeline(
    """For each tweet, describe its sentiment:

[Tweet]: "I hate it when my phone battery dies."
[Sentiment]: Negative
###
[Tweet]: "My day has been üëç"
[Sentiment]: Positive
###
[Tweet]: "This is the link to the article"
[Sentiment]: Neutral
###
[Tweet]: "This new music video was incredible"
[Sentiment]:""",
    eos_token_id=eos_token_id,
)

print(results[0]["generated_text"])
```
  - –ü—Ä–∏–º–µ—Ä 4.
```python
results = few_shot_pipeline(
    """For each food, suggest a good drink pairing:

[food]: tapas
[drink]: wine
###
[food]: pizza
[drink]: soda
###
[food]: jalapenos poppers
[drink]: beer
###
[food]: scone
[drink]:""",
    eos_token_id=eos_token_id,
)

print(results[0]["generated_text"])
```
  - –ü—Ä–∏–º–µ—Ä 5.
```python
results = few_shot_pipeline(
    """Given a word describing how someone is feeling, suggest a description of that person.  The description should not include the original word.

[word]: happy
[description]: smiling, laughing, clapping
###
[word]: nervous
[description]: glancing around quickly, sweating, fidgeting
###
[word]: sleepy
[description]: heavy-lidded, slumping, rubbing eyes
###
[word]: confused
[description]:""",
    eos_token_id=eos_token_id,
)

print(results[0]["generated_text"])
```
  - –ü—Ä–∏–º–µ—Ä 6.
```python
results = few_shot_pipeline(
    """Generate a book summary from the title:

[book title]: "Stranger in a Strange Land"
[book description]: "This novel tells the story of Valentine Michael Smith, a human who comes to Earth in early adulthood after being born on the planet Mars and raised by Martians, and explores his interaction with and eventual transformation of Terran culture."
###
[book title]: "The Adventures of Tom Sawyer"
[book description]: "This novel is about a boy growing up along the Mississippi River. It is set in the 1840s in the town of St. Petersburg, which is based on Hannibal, Missouri, where Twain lived as a boy. In the novel, Tom Sawyer has several adventures, often with his friend Huckleberry Finn."
###
[book title]: "Dune"
[book description]: "This novel is set in the distant future amidst a feudal interstellar society in which various noble houses control planetary fiefs. It tells the story of young Paul Atreides, whose family accepts the stewardship of the planet Arrakis. While the planet is an inhospitable and sparsely populated desert wasteland, it is the only source of melange, or spice, a drug that extends life and enhances mental abilities.  The story explores the multilayered interactions of politics, religion, ecology, technology, and human emotion, as the factions of the empire confront each other in a struggle for the control of Arrakis and its spice."
###
[book title]: "Blue Mars"
[book description]:""",
    eos_token_id=eos_token_id,
    max_new_tokens=50,
)

print(results[0]["generated_text"])
```


--- 

### üìå –ó–∞–¥–∞–Ω–∏—è

  - –ù–∞–π–¥–∏—Ç–µ –≤ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –∏—Å—Ç—á–æ–Ω–∏–∫–∞—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ —Å–∞–π—Ç–µ —Ñ—Ä–∏–ª–∞–Ω—Å–∞, —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã - –∑–∞–∫–∞–∑—ã, –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–æ–¥ –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ —Ç—Ä–∏ —Ç–∏–ø–∞ –∑–∞–¥–∞—á.

### üìå –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–º –ó–∞–¥–∞–Ω–∏–∏
