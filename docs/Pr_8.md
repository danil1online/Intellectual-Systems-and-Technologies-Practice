# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ7 –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ. K-Nearest Neighbors

---

## üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã.

–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞–Ω–∏—è –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–æ–º K-Nearest Neighbors

## üìö –û—Å–Ω–æ–≤–Ω—ã–µ –∏–¥–µ–∏ –∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã.

üìö –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Äî —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç–Ω–µ—Å–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–∞ –∫ –æ–¥–Ω–æ–π –∏–∑ –∑–∞—Ä–∞–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–∫–ª–∞—Å—Å–æ–≤) –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, 
–∏—Å–ø–æ–ª—å–∑—É—è –¥–∞–Ω–Ω—ã–µ, –≥–¥–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–µ—Ç–∫–∏ —É–∂–µ –∏–∑–≤–µ—Å—Ç–Ω—ã. 
–≠—Ç–æ –≤–∏–¥ _–æ–±—É—á–µ–Ω–∏—è —Å —É—á–∏—Ç–µ–ª–µ–º_, –≥–¥–µ –∞–ª–≥–æ—Ä–∏—Ç–º —É—á–∏—Ç—Å—è –Ω–∞—Ö–æ–¥–∏—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ –≤ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –∑–∞—Ç–µ–º –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –∫–ª–∞—Å—Å –¥–ª—è –Ω–æ–≤—ã—Ö, 
–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –ø–∏—Å—å–º–∞ –∫–∞–∫ "—Å–ø–∞–º" –∏–ª–∏ "–Ω–µ —Å–ø–∞–º".  

üìö –í —ç—Ç–æ–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ –≤—ã –∑–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ –≤–æ—Å–ø–æ–ª—å–∑—É–µ—Ç–µ—Å—å –º–µ—Ç–æ–¥–æ–º K-Nearest Neighbors (K-–±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π) –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–Ω–æ—à–µ–Ω–∏—è –Ω–æ–≤–æ–π —Ç–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫ —Ç–æ–º—É –∏–ª–∏ –∏–Ω–æ–º—É –∫–ª–∞—Å—Å—É. 

üìö –í –∞–ª–≥–æ—Ä–∏—Ç–º–µ K-–±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π –º–æ–¥–µ–ª—å - —ç—Ç–æ –∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–¥–±–∏—Ä–∞–µ—Ç k, –∞ –¥–ª—è –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ–π —Ç–æ—á–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è k _–±–ª–∏–∂–∞–π—à–∏—Ö_ —Ç–æ—á–µ–∫ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –∏, 
–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ, —Ç–æ—á–µ–∫ –∫–∞–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏–∑ –≤—Å–µ—Ö k –±–æ–ª—å—à–µ, –∫ —Ç–æ–º—É –∫–ª–∞—Å—Å—É –∏ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –Ω–æ–≤–∞—è —Ç–æ—á–∫–∞.

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å —Ç–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ A –∏ B. –ú—ã —Ö–æ—Ç–∏–º –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å, –∫ –∫–∞–∫–æ–º—É –∫–ª–∞—Å—Å—É –±—É–¥–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –Ω–æ–≤–∞—è —Ç–æ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö. 

–ï—Å–ª–∏ –º—ã –ø—Ä–∏–º–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ k, —Ä–∞–≤–Ω–æ–µ 3 (—Ç—Ä–∏ –±–ª–∏–∂–∞–π—à–∏–µ —Ç–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö), –º—ã –º–æ–∂–µ–º, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥–Ω–æ–∑: –Ω–æ–≤–∞—è —Ç–æ—á–∫–∞ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–ª–∞—Å—Å—É B. 

–ï—Å–ª–∏ –∂–µ –º—ã –ø—Ä–∏–º–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ k, —Ä–∞–≤–Ω–æ–µ 6, —Ç–æ —Å–∏—Ç—É–∞—Ü–∏—è –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –∏ –º—ã –ø–æ–ª—É—á–∏–º –ø—Ä–æ–≥–Ω–æ–∑ –≤ –≤–∏–¥–µ –∫–ª–∞—Å—Å–∞ A (–∞ –º–æ–∂–µ—Ç –∏ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è).

–ò–º–µ–Ω–Ω–æ –ø–æ–¥–±–æ—Ä –Ω–∞–∏–±–æ–ª–µ–µ –∞–¥–µ–∫–≤–∞—Ç–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è k - –∑–∞–¥–∞—á–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞/–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è.

---

## üìÅ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –º–µ—Ç–æ–¥—ã

- –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ - [Ubuntu 22.04](https://help.ubuntu.ru/wiki/–∫–æ–º–∞–Ω–¥–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞)
- –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äì [python](https://www.python.org/).
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
  -  [jupyter Notebook](https://jupyter.org/).
- –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
  - [matplotlib](https://matplotlib.org/)
  - [numpy](https://numpy.org/)
  - [scikit-learn](https://scikit-learn.org/)
  - [pandas](https://pandas.pydata.org/)
- –î–∞—Ç–∞—Å–µ—Ç:
  - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç ["Telecommunications dataset"](https://www.kaggle.com/code/dinaouahbi/k-nearest-neighbors-telecommunications-dataset)

**–û –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö**
–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫ —Ç–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö —É—Å–ª—É–≥ —Å–µ–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–ª —Å–≤–æ—é –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é –±–∞–∑—É –ø–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—Å–ª—É–≥, —Ä–∞–∑–¥–µ–ª–∏–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ —á–µ—Ç—ã—Ä–µ –≥—Ä—É–ø–ø—ã. 
–ï—Å–ª–∏ –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫ –≥—Ä—É–ø–ø–∞–º, –∫–æ–º–ø–∞–Ω–∏—è –º–æ–∂–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤. 
–≠—Ç–æ –∏ –µ—Å—Ç—å –∑–∞–¥–∞—á–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏. –¢–æ –µ—Å—Ç—å, –∏–º–µ—è –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏, –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞ –Ω–æ–≤–æ–≥–æ –∏–ª–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ —Å–ª—É—á–∞—è.

–í –ø—Ä–∏–º–µ—Ä–µ –æ—Å–Ω–æ–≤–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª—è–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ —Ä–µ–≥–∏–æ–Ω, –≤–æ–∑—Ä–∞—Å—Ç –∏ —Å–µ–º–µ–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ, –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π.

–¶–µ–ª–µ–≤–æ–µ –ø–æ–ª–µ, –Ω–∞–∑—ã–≤–∞–µ–º–æ–µ **custcat**, –∏–º–µ–µ—Ç —á–µ—Ç—ã—Ä–µ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —á–µ—Ç—ã—Ä–µ–º –≥—Ä—É–ø–ø–∞–º –∫–ª–∏–µ–Ω—Ç–æ–≤, –∞ –∏–º–µ–Ω–Ω–æ: 
  1 ‚Äî –ë–∞–∑–æ–≤–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ 
  2 ‚Äî –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ 
  3 ‚Äî –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ 
  4 ‚Äî –ü–æ–ª–Ω–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

–ù–∞—à–∞ —Ü–µ–ª—å ‚Äî –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å–∫–∞–∂–µ—Ç –∫–ª–∞—Å—Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤. –ò –¥–ª—è —ç—Ç–æ–≥–æ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ K –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π.
 
---

## üß™ –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç—ã 

---

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–µ–¥—ã  

**–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ [Jupyter-Hub](https://jupyter.org/hub) –ø–æ –∞–¥—Ä–µ—Å—É [Jupyter-Hub-–ò–ò–°–¢-–ù–ü–ò](http://195.133.13.56:8000/)**

![–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è](https://github.com/danil1online/intelligent_information_and_measurement_systems/blob/main/images/autorization.png)

**–° –ø–æ–º–æ—â—å—é —Ñ–∞–π–ª–æ–≤–æ–≥–æ –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å–ª–µ–≤–∞ –ø–µ—Ä–µ–π—Ç–∏ –≤ —Å–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥ (–§–ò–û –∏ –≥–æ–¥), —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ (–¥–≤–æ–π–Ω—ã–º –Ω–∞–∂–∞—Ç–∏–µ–º –º—ã—à–∏)**

![–ü–µ—Ä–µ—Ö–æ–¥ –≤ –∫–∞—Ç–∞–ª–æ–≥](../images/work_dir.png)

**–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É —Å–∏–º–≤–æ–ª–æ–º +**

![–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏](https://github.com/danil1online/intelligent_information_and_measurement_systems/blob/main/images/new_window_create.png)

**–í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏ -- Notebook**

![–°–æ–∑–¥–∞–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∏ Notebook](../images/notebook.png)

**–°–æ—Ö—Ä–∞–Ω–∏—Ç—å / –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª**

![–°–æ–∑–¥–∞–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∏ Notebook](../images/save_new_file.png)

**–†–∞–±–æ—Ç–∞—Ç—å –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ –≤–∏–¥–∞**

![–í–ª–∞–¥–∫–∞ Notebook](../images/notebook_clear_window.png)

**–ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫**

```python
import itertools
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.ticker import NullFormatter
import pandas as pd
import numpy as np
import matplotlib.ticker as ticker
from sklearn import preprocessing
from sklearn.neighbors import KNeighborsClassifier
from sklearn import metrics
%matplotlib inline
```

---

### üß™ –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã

1. üß™ **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV-—Ñ–∞–π–ª–∞**
```python
df = pd.read_csv('/home/jupyter/work/data/teleCust1000t.csv')
df['income']=df['income']*np.random.rand()
df.head()
```

2. üß™ **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö**
  - –ø–æ—Å–º–æ—Ç—Ä–∏–º, —Å–∫–æ–ª—å–∫–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –Ω–∞—à–µ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö
    ```python
    df['custcat'].value_counts()
    ```
    _281 –∫–ª–∏–µ–Ω—Ç Plus Service, 266 –∫–ª–∏–µ–Ω—Ç–æ–≤ Basic-service, 236 –∫–ª–∏–µ–Ω—Ç–æ–≤ Total Service –∏ 217 –∫–ª–∏–µ–Ω—Ç–æ–≤ E-Service_
  - –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:
    ```python
    df.hist(column='income', bins=50)
    ```
  - –ü–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫–∏–µ —É –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:
    ```python
    df.columns
    ```
  - –î–∞–Ω–Ω—ã–µ –∏–º–µ—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã, –ø–æ—ç—Ç–æ–º—É, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É scikit-learn, –Ω–∞–º –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ñ—Ä–µ–π–º –¥–∞–Ω–Ω—ã—Ö Pandas –≤ –º–∞—Å—Å–∏–≤ Numpy:
    ```python
    X = df[['region', 'tenure','age', 'marital', 'address', 'income', 'ed', 'employ','retire', 'gender', 'reside']].values  #.astype(float)
    X[0:5]
    ```
  - –ü–æ—Å—Ç—Ä–æ–∏–º, –∫–∞–∫–∏–µ —É –Ω–∞—Å –µ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã –∫–ª–∞—Å—Å–æ–≤
    ```python
    y = df['custcat'].values
    y[0:5]
    ```

3. üß™ **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**

–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω—É–ª–µ–≤–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –µ–¥–∏–Ω–∏—á–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é –¥–∞–Ω–Ω—ã—Ö (—Ç.–µ. –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ—Ç -1 –¥–æ +1). 
–≠—Ç–æ —Ö–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞, –æ—Å–æ–±–µ–Ω–Ω–æ –¥–ª—è —Ç–∞–∫–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∫–∞–∫ KNN, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏
```python
X = preprocessing.StandardScaler().fit(X).transform(X.astype(float))
X[0:5]
```

4. üß™ **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

–ö–∞—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–µ–º, –Ω–∞ —Å–∫–æ–ª—å–∫–æ –≤—ã—Å–æ–∫–∞ –µ–µ _–¢–æ—á–Ω–æ—Å—Ç—å –≤–Ω–µ –≤—ã–±–æ—Ä–∫–∏_ ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç –≤–µ—Ä–Ω—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–¥–µ–ª—å –¥–µ–ª–∞–µ—Ç –Ω–∞ –¥–∞–Ω–Ω—ã—Ö, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω–∞ –ù–ï –æ–±—É—á–∞–ª–∞—Å—å, —Ç.–µ. –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–Ω–µ–µ –Ω–µ –≤–∏–¥–µ–ª–∞.
–û–±—É—á–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –±—É–¥—É—Ç –∏–º–µ—Ç—å –Ω–∏–∑–∫—É—é _—Ç–æ—á–Ω–æ—Å—Ç—å –≤–Ω–µ –≤—ã–±–æ—Ä–∫–∏_ –∏–∑-–∑–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ [–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è](https://wiki.loginom.ru/articles/overtraining.html).

–í–∞–∂–Ω–æ, —á—Ç–æ–±—ã –Ω–∞—à–∏ –º–æ–¥–µ–ª–∏ –æ–±–ª–∞–¥–∞–ª–∏ –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é –≤–Ω–µ –≤—ã–±–æ—Ä–∫–∏, –ø–æ—Å–∫–æ–ª—å–∫—É —Ü–µ–ª—å –ª—é–±–æ–π –º–æ–¥–µ–ª–∏, –∫–æ–Ω–µ—á–Ω–æ –∂–µ, –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ–±—ã –¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã –Ω–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. 
–ö–∞–∫ –∂–µ –º–æ–∂–Ω–æ –ø–æ–≤—ã—Å–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –≤–Ω–µ –≤—ã–±–æ—Ä–∫–∏? –û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ –æ—Ü–µ–Ω–∫–∏, –Ω–∞–∑—ã–≤–∞–µ–º—ã–π —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –æ–±—É—á–∞—é—â–∏–π –∏ —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä—ã (–¥–∞—Ç–∞—Å–µ—Ç—ã). 
–¢–∞–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –±—É–∫–≤–∞–ª—å–Ω–æ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ–±—É—á–∞—é—â–∏–π –∏ —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è. 
–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–±—É—á–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –Ω–∞ –æ–±—É—á–∞—é—â–µ–º –Ω–∞–±–æ—Ä–µ, –∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º.

–≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω—É—é –æ—Ü–µ–Ω–∫—É —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤–Ω–µ –≤—ã–±–æ—Ä–∫–∏, –ø–æ—Å–∫–æ–ª—å–∫—É —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è. 
–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏–º–∏—Ç–∏—Ä—É–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é —Å–∏—Ç—É–∞—Ü–∏—é.

–•–æ—Ä–æ—à–µ–π –ø—Ä–∞–∫—Ç–∏–∫–æ–π —è–≤–ª—è–µ—Ç—Å—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–µ 50 / 50, –∞ 80 / 20, –≥–¥–µ 80 - –¥–æ–ª—è –æ–±—É—á–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –∞ 20 - –¥–æ–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö.

```python
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.2, random_state=4)
print ('Train set:', X_train.shape,  y_train.shape)
print ('Test set:', X_test.shape,  y_test.shape)
```

5. üß™ **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏**

–û–±—É—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º, –Ω–∞—à–∞ –∑–∞–¥–∞—á–∞ –ø–æ–¥–æ–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π k 
  - –ù–∞—á–Ω–µ–º —Å k=4
  ```python
  k = 4
  neigh = KNeighborsClassifier(n_neighbors = k).fit(X_train,y_train)
  neigh
  ```
  - –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ. –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ—Ç–æ–∫ –¥–ª—è —Ç–æ—á–µ–∫ _—Ç–µ—Å—Ç–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞_
  ```python
  yhat = neigh.predict(X_test)
  yhat[0:5]
  ```
  - –û—Ü–µ–Ω–∫–∞ —Ç–æ—á–Ω–æ—Å—Ç–∏

  –í –º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫–æ–≥–¥–∞ –∫–ª–∞—Å—Å–æ–≤ –±–æ–ª—å—à–µ 2, –∫–∞–∫ –≤ –Ω–∞—à–µ–π –∑–∞–¥–∞—á–µ) –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —Ç–æ—á–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ ‚Äî —ç—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ñ—É–Ω–∫—Ü–∏—è jaccard_similarity_score.
  –ü–æ —Å—É—Ç–∏, –æ–Ω–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ç–µ–ø–µ–Ω—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∏ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã—Ö –º–µ—Ç–æ–∫ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ.
  ```python
  print("Train set Accuracy: ", metrics.accuracy_score(y_train, neigh.predict(X_train)))
  print("Test set Accuracy: ", metrics.accuracy_score(y_test, yhat))
  ```
--- 

### üìå –ó–∞–¥–∞–Ω–∏–µ

- –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –º–æ–¥–µ–ªb –¥–ª—è ```k=[1;9]```
- –û—Ü–µ–Ω–∏—Ç–µ —Ç–æ—á–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ –ø–æ
  - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –≤—ã—à–µ –º–µ—Ç—Ä–∏–∫–µ [Accuracy](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.accuracy_score.html),
  - –º–µ—Ç—Ä–∏–∫–µ [F1_score](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html),
- –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫ –∏ —Å–¥–µ–ª–∞–π—Ç–µ –≤—ã–≤–æ–¥ –æ–± –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏ k

---

### üìå –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ó–∞–¥–∞–Ω–∏—è—Ö
