
# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ14 –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ. Collaborative filtering

---

## üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã.

–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞–Ω–∏—è –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –º–µ—Ç–æ–¥–æ–º –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

## üìö –û—Å–Ω–æ–≤–Ω—ã–µ –∏–¥–µ–∏ –∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã.

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π –Ω–∞–±–æ—Ä –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —á–µ–≥–æ-–ª–∏–±–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–∏ —Å–∏—Å—Ç–µ–º—ã —Å—Ç–∞–ª–∏ –ø–æ–≤—Å–µ–º–µ—Å—Ç–Ω—ã–º–∏, –∏—Ö –º–æ–∂–Ω–æ —á–∞—Å—Ç–æ —É–≤–∏–¥–µ—Ç—å –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞—Ö, –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö –ø–æ–∏—Å–∫–∞ —Ä–∞–±–æ—Ç—ã. –í —ç—Ç–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–∏—Å—Ç–µ–º—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –∏ —Ä–µ–∞–ª–∏–∑—É–µ–º –ø—Ä–æ—Å—Ç—É—é –≤–µ—Ä—Å–∏—é —Ç–∞–∫–æ–π —Å–∏—Å—Ç–µ–º—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Python –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Pandas.

---

## üìÅ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –º–µ—Ç–æ–¥—ã

- –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ - [Ubuntu 22.04](https://help.ubuntu.ru/wiki/–∫–æ–º–∞–Ω–¥–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞)
- –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äì [python](https://www.python.org/).
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
  -  [jupyter Notebook](https://jupyter.org/).
- –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
  - [matplotlib](https://matplotlib.org/)
  - [numpy](https://numpy.org/)
  - [scikit-learn](https://scikit-learn.org/)
  - [pandas](https://pandas.pydata.org/)
- –î–∞—Ç–∞—Å–µ—Ç—ã:
  - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç ["Telco Customer Churn"](https://www.kaggle.com/datasets/blastchar/telco-customer-churn)

**–û –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö**

–ú—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ª–µ–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–π –∫–æ–º–ø–∞–Ω–∏–∏ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç—Ç–æ–∫–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤. –≠—Ç–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö, –≥–¥–µ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ–¥–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞. –≠—Ç–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ª–µ–≥–∫–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å, –∏ –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–≤–ª–µ—á—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –ö–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —É–¥–µ—Ä–∂–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –æ–±—Ö–æ–¥–∏—Ç—Å—è –¥–µ—à–µ–≤–ª–µ, —á–µ–º –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö, –ø–æ—ç—Ç–æ–º—É –æ—Å–Ω–æ–≤–Ω–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ –≤ –¥–∞–Ω–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ —É–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—é —Ç–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ—Å—Ç–∞–Ω—É—Ç—Å—è —Å –∫–æ–º–ø–∞–Ω–∏–µ–π.

–≠—Ç–æ—Ç –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —Å–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —É–¥–µ—Ä–∂–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤. –í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö –∏ ‚Äã‚Äã—Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Ü–µ–ª–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏—Ö —É–¥–µ—Ä–∂–∞–Ω–∏—è.

–ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –≤–∫–ª—é—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ:

  - –ö–ª–∏–µ–Ω—Ç–∞—Ö, —É—à–µ–¥—à–∏—Ö –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –º–µ—Å—è—Ü–∞ ‚Äì —Å—Ç–æ–ª–±–µ—Ü –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è ¬´Churn¬ª
  - –£—Å–ª—É–≥–∞—Ö, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–¥–ø–∏—Å–∞–ª—Å—è –∫–∞–∂–¥—ã–π –∫–ª–∏–µ–Ω—Ç: —Ç–µ–ª–µ—Ñ–æ–Ω, –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª–∏–Ω–∏–π, –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –æ–Ω–ª–∞–π–Ω-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –æ–Ω–ª–∞–π–Ω-—Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, –∑–∞—â–∏—Ç–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞, –∞ —Ç–∞–∫–∂–µ –ø–æ—Ç–æ–∫–æ–≤–æ–µ —Ç–µ–ª–µ–≤–∏–¥–µ–Ω–∏–µ –∏ —Ñ–∏–ª—å–º—ã
  - –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –∫–ª–∏–µ–Ω—Ç–∞ ‚Äî –∫–∞–∫ –¥–æ–ª–≥–æ –æ–Ω —è–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç–æ–º, –¥–æ–≥–æ–≤–æ—Ä, —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã, —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–µ –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç–æ–≤, –µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ –∏ –æ–±—â–∞—è —Å—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π
  - –î–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö: –ø–æ–ª, –≤–æ–∑—Ä–∞—Å—Ç, –Ω–∞–ª–∏—á–∏–µ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ –∏ –∏–∂–¥–∏–≤–µ–Ω—Ü–µ–≤

---

## üß™ –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç—ã 

---

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–µ–¥—ã  

**–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ [Jupyter-Hub](https://jupyter.org/hub) –ø–æ –∞–¥—Ä–µ—Å—É [Jupyter-Hub-–ò–ò–°–¢-–ù–ü–ò](http://195.133.13.56:8000/)**

![–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è](https://github.com/danil1online/intelligent_information_and_measurement_systems/blob/main/images/autorization.png)

**–° –ø–æ–º–æ—â—å—é —Ñ–∞–π–ª–æ–≤–æ–≥–æ –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å–ª–µ–≤–∞ –ø–µ—Ä–µ–π—Ç–∏ –≤ —Å–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥ (–§–ò–û –∏ –≥–æ–¥), —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ (–¥–≤–æ–π–Ω—ã–º –Ω–∞–∂–∞—Ç–∏–µ–º –º—ã—à–∏)**

![–ü–µ—Ä–µ—Ö–æ–¥ –≤ –∫–∞—Ç–∞–ª–æ–≥](../images/work_dir.png)

**–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É —Å–∏–º–≤–æ–ª–æ–º +**

![–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏](https://github.com/danil1online/intelligent_information_and_measurement_systems/blob/main/images/new_window_create.png)

**–í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏ -- Notebook**

![–°–æ–∑–¥–∞–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∏ Notebook](../images/notebook.png)

**–°–æ—Ö—Ä–∞–Ω–∏—Ç—å / –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª**

![–°–æ–∑–¥–∞–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∏ Notebook](../images/save_new_file.png)

**–†–∞–±–æ—Ç–∞—Ç—å –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ –≤–∏–¥–∞**

![–í–ª–∞–¥–∫–∞ Notebook](../images/notebook_clear_window.png)

**–ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫**

```python
import pandas as pd
import pylab as pl
import numpy as np
import scipy.optimize as opt
from sklearn import preprocessing
%matplotlib inline 
import matplotlib.pyplot as plt
```

---

### üß™ –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –†–µ—à–∞—é—â–∏—Ö –î–µ—Ä–µ–≤—å–µ–≤ –∫ –∑–∞–¥–∞—á–µ –æ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞—Ö

1. üß™ **–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é pandas dataframe**
    ```python
    churn_df = pd.read_csv("/home/jupyter/work/data/ChurnData.csv")
    churn_df.head()
    ```

2. üß™ **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ—Ç–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö**
  - –í—ã–±–µ—Ä–µ–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è. –¢–∞–∫–∂–µ –∏–∑–º–µ–Ω–∏–º —Ü–µ–ª–µ–≤–æ–π —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Ü–µ–ª–æ—á–∏—Å–ª–µ–Ω–Ω—ã–π, –∫–∞–∫ —Ç–æ–≥–æ —Ç—Ä–µ–±—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º skitlearn:
    ```python
    churn_df = churn_df[['tenure', 'age', 'address', 'income', 'ed', 'employ', 'equip', 
                     'callcard', 'wireless','churn']]
    churn_df['churn'] = churn_df['churn'].astype('int')
    churn_df.head()
    ```
  - –û–ø—Ä–µ–¥–µ–ª–∏–º X –∏ y –¥–ª—è –Ω–∞—à–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
    ```python
    X = np.asarray(churn_df[['tenure', 'age', 'address', 'income', 'ed', 
                             'employ', 'equip']])
    X[0:5]
    ```

    ```python
    y = np.asarray(churn_df['churn'])
    y [0:5]
    ```

  - –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö:
    ```python
    from sklearn import preprocessing
    X = preprocessing.StandardScaler().fit(X).transform(X)
    X[0:5]
    ```
3. üß™ **–ù–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**

–†–∞–∑–¥–µ–ª–∏–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ–±—É—á–∞—é—â–∏–π –∏ —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä—ã:

```python
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, 
                                                    random_state=4)
print ('Train set:', X_train.shape,  y_train.shape)
print ('Test set:', X_test.shape,  y_test.shape)
```

4. üß™ **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥–µ–ª–∏**

```python
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import confusion_matrix
LR = LogisticRegression(C=0.01, solver='liblinear').fit(X_train,y_train)
LR
```

5. üß™ **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

  - –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É –º–æ–¥–µ–ª–∏
```python
yhat = LR.predict(X_test)
yhat
```
  - –§—É–Ω–∫—Ü–∏—è _predict_proba_ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ü–µ–Ω–∫–∏ –¥–ª—è –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤, —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ –ø–æ –º–µ—Ç–∫–∞–º –∫–ª–∞—Å—Å–æ–≤. –ü–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü ‚Äî —ç—Ç–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∞ 1, P(Y=1|X), –∞ –≤—Ç–æ—Ä–æ–π —Å—Ç–æ–ª–±–µ—Ü ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∞ 0, P(Y=0|X):
```python
yhat_prob = LR.predict_proba(X_test)
yhat_prob
```

6. üß™ **–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏**

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–µ—Ç—Ä–∏–∫–∏ –∏–∑ sklearn –∏ –ø—Ä–æ–≤–µ—Ä–∏–º —Ç–æ—á–Ω–æ—Å—Ç—å –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏.

  - –ò–Ω–¥–µ–∫—Å –ñ–∞–∫–∫–∞—Ä–∞. –ú–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫ —Ä–∞–∑–º–µ—Ä –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è, –¥–µ–ª—ë–Ω–Ω—ã–π –Ω–∞ —Ä–∞–∑–º–µ—Ä –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –¥–≤—É—Ö –Ω–∞–±–æ—Ä–æ–≤ –º–µ—Ç–æ–∫. –ï—Å–ª–∏ –≤–µ—Å—å –Ω–∞–±–æ—Ä –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫ –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ —Å—Ç—Ä–æ–≥–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∏—Å—Ç–∏–Ω–Ω—ã–º –Ω–∞–±–æ—Ä–æ–º –º–µ—Ç–æ–∫, —Ç–æ —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ä–∞–≤–Ω–∞ 1,0; –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ ‚Äî 0,0

```python
from sklearn.metrics import jaccard_score
jaccard_score(y_test, yhat, pos_label=1)
```

  - –ú–∞—Ç—Ä–∏–∞—Ü–∞ –∑–∞–ø—É—Ç–∞–Ω–Ω–æ—Å—Ç–∏
```python
from sklearn.metrics import classification_report, confusion_matrix
import itertools
def plot_confusion_matrix(cm, classes,
                          normalize=False,
                          title='Confusion matrix',
                          cmap=plt.cm.Blues):
    if normalize:
        cm = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]
        print("Normalized confusion matrix")
    else:
        print('Confusion matrix, without normalization')

    print(cm)

    plt.imshow(cm, interpolation='nearest', cmap=cmap)
    plt.title(title)
    plt.colorbar()
    tick_marks = np.arange(len(classes))
    plt.xticks(tick_marks, classes, rotation=45)
    plt.yticks(tick_marks, classes)

    fmt = '.2f' if normalize else 'd'
    thresh = cm.max() / 2.
    for i, j in itertools.product(range(cm.shape[0]), range(cm.shape[1])):
        plt.text(j, i, format(cm[i, j], fmt),
                 horizontalalignment="center",
                 color="white" if cm[i, j] > thresh else "black")

    plt.tight_layout()
    plt.ylabel('True label')
    plt.xlabel('Predicted label')
print(confusion_matrix(y_test, yhat, labels=[1,0]))

cnf_matrix = confusion_matrix(y_test, yhat, labels=[1,0])
np.set_printoptions(precision=2)

plt.figure()
plot_confusion_matrix(cnf_matrix, classes=['churn=1','churn=0'],normalize= False,
                      title='Confusion matrix')
```

```python
print (classification_report(y_test, yhat))
```

```python
from sklearn.metrics import log_loss
log_loss(y_test, yhat_prob)
```

--- 

### üìå –ó–∞–¥–∞–Ω–∏—è

  - –ü–æ—Å—Ç—Ä–æ–π—Ç–µ 4 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ —Å —Ä–µ—à–∞—Ç–µ–ª—è–º–∏ 'newton-cg', 'lbfgs', 'sag' –∏ 'saga'
  - –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–≤–æ, —Å–¥–µ–ª–∞–π—Ç–µ –≤—ã–≤–æ–¥—ã –æ–± –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞—Ö –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞—Ö –∫–∞–∂–¥–æ–≥–æ —Ä–µ—à–∞—Ç–µ–ª—è, –æ–±–æ—Å–Ω—É–π—Ç–µ —Ç–∞–∫–æ–≤—ã–µ

### üìå –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–º –ó–∞–¥–∞–Ω–∏–∏
