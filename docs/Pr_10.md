# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ10 –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ. Hierarchical Clustering

---

## üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã.

–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞–Ω–∏—è –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–æ–º Hierarchical Clustering

## üìö –û—Å–Ω–æ–≤–Ω—ã–µ –∏–¥–µ–∏ –∏ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã.

–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (—Ç–∞–∫–∂–µ, —á—Ç–æ –≥—Ä–∞—Ñ–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–π –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑) ‚Äî —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ —É–ø–æ—Ä—è–¥–æ—á–∏–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ (–¥–µ—Ä–µ–≤–∞) –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤. 
–í—ã–¥–µ–ª—è—é—Ç –¥–≤–∞ –∫–ª–∞—Å—Å–∞ –º–µ—Ç–æ–¥–æ–≤ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏:
  - –ê–≥–ª–æ–º–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã (–∞–Ω–≥–ª. agglomerative): –Ω–æ–≤—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—É—Ç–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –±–æ–ª–µ–µ –º–µ–ª–∫–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –∏, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–µ—Ä–µ–≤–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ—Ç –ª–∏—Å—Ç—å–µ–≤ –∫ —Å—Ç–≤–æ–ª—É;
  - divisive: –Ω–æ–≤—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø—É—Ç–µ–º –¥–µ–ª–µ–Ω–∏—è –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –Ω–∞ –±–æ–ª–µ–µ –º–µ–ª–∫–∏–µ –∏, —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –¥–µ—Ä–µ–≤–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ—Ç —Å—Ç–≤–æ–ª–∞ –∫ –ª–∏—Å—Ç—å—è–º.

–ê–ª–≥–æ—Ä–∏—Ç–º—ã –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—é—Ç, —á—Ç–æ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å—Ç–µ–ø–µ–Ω—å—é —Å–≤—è–∑–Ω–æ—Å—Ç–∏.

---

## üìÅ –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –º–µ—Ç–æ–¥—ã

- –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ - [Ubuntu 22.04](https://help.ubuntu.ru/wiki/–∫–æ–º–∞–Ω–¥–Ω–∞—è_—Å—Ç—Ä–æ–∫–∞)
- –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è ‚Äì [python](https://www.python.org/).
- –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:
  -  [jupyter Notebook](https://jupyter.org/).
- –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
  - [matplotlib](https://matplotlib.org/)
  - [numpy](https://numpy.org/)
  - [scikit-learn](https://scikit-learn.org/)
  - [pandas](https://pandas.pydata.org/)
  - [Scipy](https://scipy.org/)
- –î–∞—Ç–∞—Å–µ—Ç:
  - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - [—Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç](https://www.kaggle.com/code/ammaraahmad/machine-learning-essentials/data?select=cars_clus.csv)

 
---

## üß™ –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ä–∞–±–æ—Ç—ã 

---

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–µ–¥—ã  

**–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ [Jupyter-Hub](https://jupyter.org/hub) –ø–æ –∞–¥—Ä–µ—Å—É [Jupyter-Hub-–ò–ò–°–¢-–ù–ü–ò](http://195.133.13.56:8000/)**

**–° –ø–æ–º–æ—â—å—é —Ñ–∞–π–ª–æ–≤–æ–≥–æ –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä–∞, —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–Ω–æ–≥–æ —Å–ª–µ–≤–∞ –ø–µ—Ä–µ–π—Ç–∏ –≤ —Å–≤–æ–π –∫–∞—Ç–∞–ª–æ–≥ (–§–ò–û –∏ –≥–æ–¥), —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ä–∞–Ω–µ–µ (–¥–≤–æ–π–Ω—ã–º –Ω–∞–∂–∞—Ç–∏–µ–º –º—ã—à–∏)**

**–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–∫–ª–∞–¥–∫—É —Å–∏–º–≤–æ–ª–æ–º +**

**–í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–∏ -- Notebook**

**–°–æ—Ö—Ä–∞–Ω–∏—Ç—å / –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ñ–∞–π–ª**

**–†–∞–±–æ—Ç–∞—Ç—å –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ –≤–∏–¥–∞**

![–í–ª–∞–¥–∫–∞ Notebook](../images/notebook_clear_window.png)

**–ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫**

```python
import numpy as np 
import pandas as pd
from scipy import ndimage 
from scipy.cluster import hierarchy 
from scipy.spatial import distance_matrix 
from matplotlib import pyplot as plt 
from sklearn import manifold, datasets 
from sklearn.cluster import AgglomerativeClustering 
from sklearn.datasets import make_blobs 
%matplotlib inline
```

---

### üß™ –ê–≥–ª–æ–º–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –Ω–∞ —Å–ª—É—á–∞–π–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö

1. üß™ **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
  - –ó–∞–¥–∞–µ–º _—Ü–µ–Ω—Ç—Ä –æ—Ç—Å—á–µ—Ç–∞_ –¥–ª—è –≤—Å–µ—Ö –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    ```python
    np.random.seed(0)
    ```
  - –°–æ–∑–¥–∞–¥–∏–º —Å–ª—É—á–∞–π–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã —Ç–æ—á–µ–∫ —Å –ø–æ–º–æ—â—å—é –∫–ª–∞—Å—Å–∞ [make_blobs](Pr_7.md#-k-—Å—Ä–µ–¥–Ω–∏—Ö-–Ω–∞-—Å–ª—É—á–∞–π–Ω–æ-—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º-–Ω–∞–±–æ—Ä–µ-–¥–∞–Ω–Ω—ã—Ö).
    ```python
    X1, y1 = make_blobs(n_samples=50, 
                        centers=[[4,4], [-2, -1], [1, 1], [10,4]], 
                        cluster_std=0.9)
    ```
  - –ü–æ—Å–º–æ—Ç—Ä–∏–º –¥–∏–∞–≥—Ä–∞–º–º—É —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ç–æ—á–µ–∫ –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏:
    ```python
    plt.scatter(X1[:, 0], X1[:, 1], marker='o') 
    ```

2. üß™ **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ (–æ–±—É—á–µ–Ω–∏–µ) –º–æ–¥–µ–ª–∏ K-Means**
  - –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–ª–∞—Å—Å [AgglomerativeClustering](https://scikit-learn.org/stable/modules/generated/sklearn.cluster.AgglomerativeClustering.html).
  –û–Ω –∏–º–µ–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –Ω–æ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –¥–≤–∞:
    - **n_clusters** - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å, –∞ —Ç–∞–∫–∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
    - **linkage** - –∫–∞–∫–æ–π –∫—Ä–∏—Ç–µ—Ä–∏–π —Å—Ü–µ–ø–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å; –∫—Ä–∏—Ç–µ—Ä–∏–π —Å—Ü–µ–ø–ª–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –Ω–∞–±–æ—Ä–∞–º–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π; –∞–ª–≥–æ—Ä–∏—Ç–º –æ–±—ä–µ–¥–∏–Ω–∏—Ç –ø–∞—Ä—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—â–∏–µ —ç—Ç–æ—Ç –∫—Ä–∏—Ç–µ—Ä–∏–π
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç agglom, –∫–∞–∫ —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—Å–∞ AgglomerativeClustering:
    ```python
    agglom = AgglomerativeClustering(n_clusters = 4, linkage = 'complete')
    ```
  - –û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å –Ω–∞ –º–∞—Ç—Ä–∏—Ü–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ **X**, –∫–æ—Ç–æ—Ä—É—é –º—ã —Å–æ–∑–¥–∞–ª–∏ –≤—ã—à–µ (**Y** –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º, –ø–æ—ç—Ç–æ–º—É —ç—Ç–æ –º–µ—Ç–æ–¥ –æ–±—É—á–µ–Ω–∏—è _–±–µ–∑ —É—á–∏—Ç–µ–ª—è_)
    ```python
    agglom.fit(X1,y1)
    ```
  - –ü–æ—Å—Ç—Ä–æ–∏–º –¥–∏–∞–≥—Ä–∞–º–º—É —Å –Ω–∞—à–∏–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏
    ```python
    plt.figure(figsize=(6,4))
    
    x_min, x_max = np.min(X1, axis=0), np.max(X1, axis=0)
    
    X1 = (X1 - x_min) / (x_max - x_min)
    
    for i in range(X1.shape[0]):
        plt.text(X1[i, 0], X1[i, 1], str(y1[i]),
                 color=plt.cm.nipy_spectral(agglom.labels_[i] / 10.),
                 fontdict={'weight': 'bold', 'size': 9})
        
    plt.xticks([])
    plt.yticks([])
    
    plt.scatter(X1[:, 0], X1[:, 1], marker='.')
    plt.show()
    ```
  - distance_matrix - —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –¥–æ –∫–∞–∂–¥–æ–π –¥—Ä—É–≥–æ–π —Ç–æ—á–∫–∏ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö. –§—É–Ω–∫—Ü–∏—è distance_matrix —Ç—Ä–µ–±—É–µ—Ç –¥–≤—É—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
  –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–∞—Ç—Ä–∏—Ü—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ X2 –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±–æ–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –º–∞—Ç—Ä–∏—Ü—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π dist_matrix.
  –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã —Å –¥–∏–∞–≥–æ–Ω–∞–ª—å—é, —Ä–∞–≤–Ω–æ–π –Ω—É–ª—é. –≠—Ç–æ –æ–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ —É–±–µ–¥–∏—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –≤–∞—à–µ–π –º–∞—Ç—Ä–∏—Ü—ã.
    ```python
    dist_matrix = distance_matrix(X1,X1) 
    print(dist_matrix)
    ```
  - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ –≤–∏–¥–µ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—ã.
  –ö–∞–∂–¥–æ–µ —Å–ª–∏—è–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–µ–π.
  –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞ Y –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ª–∏–Ω–∏–∏ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Å—Ç–µ–ø–µ–Ω—å —Å—Ö–æ–¥—Å—Ç–≤–∞ –¥–≤—É—Ö –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –≥–¥–µ –∞–≥–ª–æ–º–µ—Ä–∞—Ü–∏–∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã.
  –ü–µ—Ä–µ—Ö–æ–¥—è –æ—Ç –Ω–∏–∂–Ω–µ–≥–æ —Å–ª–æ—è –∫ –≤–µ—Ä—Ö–Ω–µ–º—É —É–∑–ª—É, –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–ª–∏—è–Ω–∏–π, –ø—Ä–∏–≤–µ–¥—à–∏—Ö –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–Ω–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏.
    ```python
    Z = hierarchy.linkage(dist_matrix, 'complete')
    dendro = hierarchy.dendrogram(Z)
    ```

--- 

### üìå –ó–∞–¥–∞–Ω–∏–µ ‚Ññ1

- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **linkage** = ‚Äòward‚Äô, ‚Äòaverage‚Äô, ‚Äòsingle‚Äô
- –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ 

---

### üß™ –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤–∞—Ö

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–µ–±–µ, —á—Ç–æ –∞–≤—Ç–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–ª –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã –Ω–æ–≤–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è. 
–ü—Ä–µ–∂–¥–µ —á–µ–º –≤–≤–µ—Å—Ç–∏ –Ω–æ–≤—É—é –º–æ–¥–µ–ª—å –≤ —Å–≤–æ–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å —Ö–æ—á–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–∏–µ –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –Ω–∞ —Ä—ã–Ω–∫–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–∏ –Ω–∞ –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã, —Ç–æ –µ—Å—Ç—å, –∫–∞–∫ –º–æ–∂–Ω–æ —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª–∏, –∫–∞–∫–∞—è –≥—Ä—É–ø–ø–∞ –Ω–∞–∏–±–æ–ª–µ–µ –±–ª–∏–∑–∫–∞ –∫ –¥–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Å –∫–∞–∫–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ –æ–Ω–∏ –±—É–¥—É—Ç –∫–æ–Ω–∫—É—Ä–∏—Ä–æ–≤–∞—Ç—å.

–ù–∞—à–∞ —Ü–µ–ª—å ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –Ω–∞–∏–±–æ–ª–µ–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –≥—Ä—É–ø–ø –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π. 
–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –æ–±–æ–±—â–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª—è—Ö –∏ –ø–æ–º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è–º –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –æ –ø–æ—Å—Ç–∞–≤–∫–∞—Ö –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π.

1. üß™ **–ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV-—Ñ–∞–π–ª–∞**

```python
pdf = pd.read_csv('/home/jupyter/work/data/cars_clus.csv')
print ("Shape of dataset: ", pdf.shape)
pdf.head()
```

–ù–∞–±–æ—Ä—ã —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –≤–∫–ª—é—á–∞—é—Ç:
  - —Ü–µ–Ω—É (price),
  - –æ–±—ä–µ–º –¥–≤–∏–≥–∞—Ç–µ–ª—è (engine_s),
  - –º–æ—â–Ω–æ—Å—Ç—å –¥–≤–∏–≥–∞—Ç–µ–ª—è –≤ –ª–æ—à–∞–¥–∏–Ω—ã—Ö —Å–∏–ª–∞—Ö (horsepow),
  - –∫–æ–ª–µ—Å–Ω—É—é –±–∞–∑—É (wheelbas),
  - —à–∏—Ä–∏–Ω—É (width),
  - –¥–ª–∏–Ω—É (length),
  - –ø–æ–ª–Ω—É—é –º–∞—Å—Å—É (curb_wgt),
  - –µ–º–∫–æ—Å—Ç—å —Ç–æ–ø–ª–∏–≤–Ω–æ–≥–æ –±–∞–∫–∞ (fuel_cap)
  - —ç–∫–æ–Ω–æ–º–∏—á–Ω–æ—Å—Ç—å —Ä–∞—Å—Ö–æ–¥–∞ —Ç–æ–ø–ª–∏–≤–∞ (mpg).

2. üß™ **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**

–û—á–∏—Å—Ç–∏–º –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, —É–¥–∞–ª–∏–≤ —Å—Ç—Ä–æ–∫–∏, –∏–º–µ—é—â–∏–µ –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

```python
print ("Shape of dataset before cleaning: ", pdf.size)
pdf[[ 'sales', 'resale', 'type', 'price', 'engine_s',
       'horsepow', 'wheelbas', 'width', 'length', 'curb_wgt', 'fuel_cap',
       'mpg', 'lnsales']] = pdf[['sales', 'resale', 'type', 'price', 'engine_s',
       'horsepow', 'wheelbas', 'width', 'length', 'curb_wgt', 'fuel_cap',
       'mpg', 'lnsales']].apply(pd.to_numeric, errors='coerce')
pdf = pdf.dropna()
pdf = pdf.reset_index(drop=True)
print ("Shape of dataset after cleaning: ", pdf.size)
pdf.head(5)
```

3. üß™ **–í—ã–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏**

```python
featureset = pdf[['engine_s',  'horsepow', 'wheelbas', 'width', 
                  'length', 'curb_wgt', 'fuel_cap', 'mpg']]
```

4. üß™ **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è**

–¢–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. 
[MinMaxScaler](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html) –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏, –º–∞—Å—à—Ç–∞–±–∏—Ä—É—è –∫–∞–∂–¥—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –¥–æ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞. 
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç—Ç–æ (0, 1). –¢–æ –µ—Å—Ç—å, —ç—Ç–æ —Å—Ä–µ–¥—Å—Ç–≤–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∫–∞–∂–¥—ã–π –ø—Ä–∏–∑–Ω–∞–∫ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ, —Ç–∞–∫ —á—Ç–æ –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç –Ω—É–ª—è –¥–æ –µ–¥–∏–Ω–∏—Ü—ã.

```python
from sklearn.preprocessing import MinMaxScaler
x = featureset.values #returns a numpy array
min_max_scaler = MinMaxScaler()
feature_mtx = min_max_scaler.fit_transform(x)
feature_mtx [0:5]
```
    
5. üß™ **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Scipy**
  - –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–∞–∫–µ—Ç Scipy –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, —Å–Ω–∞—á–∞–ª–∞ –º—ã –≤—ã—á–∏—Å–ª—è–µ–º –º–∞—Ç—Ä–∏—Ü—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π
    ```python
    import scipy
    leng = feature_mtx.shape[0]
    D = np.zeros([leng,leng])
    for i in range(leng):
        for j in range(leng):
            D[i,j] = scipy.spatial.distance.euclidean(feature_mtx[i], feature_mtx[j])
    ```
    
  - –ü—Ä–∏ –∞–≥–ª–æ–º–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–ª—è—Ç—å –º–∞—Ç—Ä–∏—Ü—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π, —á—Ç–æ–±—ã –æ—Ç—Ä–∞–∑–∏—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –≤–Ω–æ–≤—å —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–ª–∞—Å—Ç–µ—Ä–æ–º –∏ –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ –≤ –ª–µ—Å—É.
  –í Scipy –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ [–º–µ—Ç–æ–¥—ã —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è](https://docs.scipy.org/doc/scipy/reference/cluster.hierarchy.html) –º–µ–∂–¥—É –≤–Ω–æ–≤—å —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–ª–∞—Å—Ç–µ—Ä–æ–º –∏ –∫–∞–∂–¥—ã–º –∫–ª–∞—Å—Ç–µ—Ä–æ–º:
    - –µ–¥–∏–Ω–∏—á–Ω—ã–π;
    - –ø–æ–ª–Ω—ã–π;
    - —É—Å—Ä–µ–¥–Ω–µ–Ω–Ω—ã–π;
    - –≤–∑–≤–µ—à–µ–Ω–Ω—ã–π;
    - —Ü–µ–Ω—Ç—Ä–æ–∏–¥–Ω—ã–π.
  –í –ø—Ä–∏–º–µ—Ä–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–ª–Ω—ã–π (complete).
    ```python
    import pylab
    import scipy.cluster.hierarchy
    Z = hierarchy.linkage(D, 'complete')
    ```

  - –ü–æ —Å—É—Ç–∏, –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∑–∞—Ä–∞–Ω–µ–µ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤. 
  –û–¥–Ω–∞–∫–æ, –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –∫–∞–∫ –ø—Ä–∏ –ø–ª–æ—Å–∫–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏. 
  –ü–æ—ç—Ç–æ–º—É –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ–∫—É—â—É—é –ª–∏–Ω–∏—é:
  ```python
  from scipy.cluster.hierarchy import fcluster
  max_d = 3
  clusters = fcluster(Z, max_d, criterion='distance')
  clusters
  ```

  - –¢–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–ø—Ä—è–º—É—é –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤:
  ```python
  from scipy.cluster.hierarchy import fcluster
  k = 5
  clusters = fcluster(Z, k, criterion='maxclust')
  clusters
  ```

  - –¢–µ–ø–µ—Ä—å –ø–æ—Å—Ç—Ä–æ–∏–º –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—É:
  ```python
  fig = pylab.figure(figsize=(18,50))
  def llf(id):
      return '[%s %s %s]' % (pdf['manufact'][id], pdf['model'][id], 
                             int(float(pdf['type'][id])) )
      
  dendro = hierarchy.dendrogram(Z,  leaf_label_func=llf, leaf_rotation=0, 
                                leaf_font_size =12, orientation = 'right')
  ```
--- 

### üìå –ó–∞–¥–∞–Ω–∏–µ ‚Ññ2

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å–µ –∏–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã linkage –∏–∑ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://docs.scipy.org/doc/scipy/reference/cluster.hierarchy.html). –í—ã–±–µ—Ä–∏—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –Ω–∞ –≤–∞—à –≤–∑–≥–ª—è–¥ –∏ –æ–±–æ—Å–Ω—É–π—Ç–µ.

---

5. üß™ **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º scikit-learn**
  - –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é AgglomerativeClustering –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ scikit-learn –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö. AgglomerativeClustering –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é, –∏—Å–ø–æ–ª—å–∑—É—è –ø–æ–¥—Ö–æ–¥ ¬´—Å–Ω–∏–∑—É –≤–≤–µ—Ä—Ö¬ª. –ö—Ä–∏—Ç–µ—Ä–∏–π —Å–≤—è–∑—ã–≤–∞–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–µ—Ç—Ä–∏–∫—É, –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å–ª–∏—è–Ω–∏—è:
    - Ward –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç —Å—É–º–º—É –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ —Ä–∞–∑–Ω–æ—Å—Ç–µ–π –≤–Ω—É—Ç—Ä–∏ –≤—Å–µ—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤. –≠—Ç–æ –ø–æ–¥—Ö–æ–¥, –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—â–∏–π –¥–∏—Å–ø–µ—Ä—Å–∏—é, –∏ –≤ —ç—Ç–æ–º —Å–º—ã—Å–ª–µ –æ–Ω –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ k-—Å—Ä–µ–¥–Ω–∏—Ö, –Ω–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–≥–ª–æ–º–µ—Ä–∞—Ç–∏–≤–Ω–æ-–∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
    - Maximum –∏–ª–∏ complete –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –Ω–∞–±–ª—é–¥–µ–Ω–∏—è–º–∏ –ø–∞—Ä –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
    - Average –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –º–µ–∂–¥—É –≤—Å–µ–º–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è–º–∏ –ø–∞—Ä –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
    ```python
    dist_matrix = distance_matrix(feature_mtx,feature_mtx) 
    agglom = AgglomerativeClustering(n_clusters = 6, linkage = 'complete')
    agglom.fit(feature_mtx)
    agglom.labels_
    ```
    
  - –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –ø–æ–ª–µ –≤ –Ω–∞—à —Ñ—Ä–µ–π–º –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏:
    ```python
    pdf['cluster_'] = agglom.labels_
    pdf.head()
    ```

  - –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:
  ```python
  import matplotlib.cm as cm
  n_clusters = max(agglom.labels_)+1
  colors = cm.rainbow(np.linspace(0, 1, n_clusters))
  cluster_labels = list(range(0, n_clusters))
  
  plt.figure(figsize=(16,14))
  
  for color, label in zip(colors, cluster_labels):
      subset = pdf[pdf.cluster_ == label]
      for i in subset.index:
              plt.text(subset.horsepow[i], subset.mpg[i], 
                       str(subset['model'][i]), rotation=25) 
      plt.scatter(subset.horsepow, subset.mpg, s= subset.price*10, 
                  c=color, label='cluster'+str(label),alpha=0.5)
  plt.legend()
  plt.title('Clusters')
  plt.xlabel('horsepow')
  plt.ylabel('mpg')
  ```

  - –í–∏–¥–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ —Å –ø–æ–º–æ—â—å—é –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–∞—Å—Å–µ—è–Ω–∏—è, –Ω–æ –Ω–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è—Ç–Ω–æ, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ü–µ–Ω—Ç—Ä–æ–∏–¥ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞. –ë–æ–ª–µ–µ —Ç–æ–≥–æ, –≤ –Ω–∞—à–µ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö –µ—Å—Ç—å –¥–≤–∞ —Ç–∏–ø–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤: ¬´–≥—Ä—É–∑–æ–≤–∏–∫¬ª (–∑–Ω–∞—á–µ–Ω–∏–µ 1 –≤ —Å—Ç–æ–ª–±—Ü–µ ¬´–¢–∏–ø¬ª) –∏ ¬´–ª–µ–≥–∫–æ–≤–æ–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å¬ª (–∑–Ω–∞—á–µ–Ω–∏–µ 1 –≤ —Å—Ç–æ–ª–±—Ü–µ ¬´–¢–∏–ø¬ª). –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ –∏ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞. –°–Ω–∞—á–∞–ª–∞ –º—ã –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª—É—á–∞–µ–≤ –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ:
  ```python
  pdf.groupby(['cluster_','type'])['cluster_'].count()
  ```

  - –¢–µ–ø–µ—Ä—å —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞::
  ```python
  agg_cars = pdf.groupby(['cluster_','type'])[['horsepow','engine_s','mpg','price']].mean()
  agg_cars
  ```
–û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å 3 –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞, –≤ –∫–æ—Ç–æ—Ä—ã—Ö —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤.

–ê–≤—Ç–æ–º–æ–±–∏–ª–∏ :
  - –ö–ª–∞—Å—Ç–µ—Ä 1: —Å –±–ª–∏–∑–∫–∏–º –∫ –≤—ã—Å–æ–∫–æ–º—É —Ä–∞—Å—Ö–æ–¥–æ–º —Ç–æ–ø–ª–∏–≤–∞ –∏ –Ω–∏–∑–∫–æ–π –º–æ—â–Ω–æ—Å—Ç—å—é –¥–≤–∏–≥–∞—Ç–µ–ª—è
  - –ö–ª–∞—Å—Ç–µ—Ä 2: —Å —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Ä–∞—Å—Ö–æ–¥–æ–º —Ç–æ–ø–ª–∏–≤–∞ –∏ –º–æ—â–Ω–æ—Å—Ç—å—é, –Ω–æ —Ü–µ–Ω–æ–π –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–π
  - –ö–ª–∞—Å—Ç–µ—Ä 3: —Å –Ω–∏–∑–∫–∏–º —Ä–∞—Å—Ö–æ–¥–æ–º —Ç–æ–ø–ª–∏–≤–∞, –≤—ã—Å–æ–∫–æ–π –º–æ—â–Ω–æ—Å—Ç—å—é –∏ —Å–∞–º–æ–π –≤—ã—Å–æ–∫–æ–π —Ü–µ–Ω–æ–π

–ì—Ä—É–∑–æ–≤–∏–∫–∏ :
  - –ö–ª–∞—Å—Ç–µ—Ä 1: —Å –ø–æ—á—Ç–∏ —Å–∞–º—ã–º –≤—ã—Å–æ–∫–∏–º —Ä–∞—Å—Ö–æ–¥–æ–º —Ç–æ–ø–ª–∏–≤–∞ —Å—Ä–µ–¥–∏ –≥—Ä—É–∑–æ–≤–∏–∫–æ–≤ –∏ —Å–∞–º—ã–º–∏ –Ω–∏–∑–∫–∏–º–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º –º–æ—â–Ω–æ—Å—Ç–∏ –∏ —Ü–µ–Ω—ã
  - –ö–ª–∞—Å—Ç–µ—Ä 2: —Å –ø–æ—á—Ç–∏ —á—Ç–æ –Ω–∏–∑–∫–∏–º —Ä–∞—Å—Ö–æ–¥–æ–º —Ç–æ–ø–ª–∏–≤–∞ –∏ —Å—Ä–µ–¥–Ω–µ–π –º–æ—â–Ω–æ—Å—Ç—å—é, –Ω–æ —Ü–µ–Ω–æ–π –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–π
  - –ö–ª–∞—Å—Ç–µ—Ä 3: —Å —Ö–æ—Ä–æ—à–∏–º —Ä–∞—Å—Ö–æ–¥–æ–º —Ç–æ–ø–ª–∏–≤–∞ –∏ –º–æ—â–Ω–æ—Å—Ç—å—é, –Ω–∏–∑–∫–æ–π —Ü–µ–Ω–æ–π

–ü—Ä–∏ —ç—Ç–æ–º –º—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ç–∏–ø –∏ —Ü–µ–Ω—É –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏, –Ω–æ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –º–æ–∂–µ—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä—ã –∏ —Ä–∞–∑–ª–∏—á–∞—Ç—å –∏—Ö —Å –¥–æ–≤–æ–ª—å–Ω–æ –≤—ã—Å–æ–∫–æ–π —Ç–æ—á–Ω–æ—Å—Ç—å—é. 

–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:
```python
plt.figure(figsize=(16,10))
for color, label in zip(colors, cluster_labels):
    subset = agg_cars.loc[(label,),]
    for i in subset.index:
        plt.text(subset.loc[i][0]+5, subset.loc[i][2], 'type='+str(int(i)) + ',\
        price='+str(int(subset.loc[i][3]))+'k')
    plt.scatter(subset.horsepow, subset.mpg, s=subset.price*20, c=color, 
                label='cluster'+str(label))
plt.legend()
plt.title('Clusters')
plt.xlabel('horsepow')
plt.ylabel('mpg')
```
--- 

### üìå –ó–∞–¥–∞–Ω–∏–µ ‚Ññ2

–ü—Ä–æ–≤–µ–¥–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã, —Å–¥–µ–ª–∞–π—Ç–µ –≤—ã–≤–æ–¥—ã –æ–± –æ—Å–Ω–æ–≤–Ω–æ–º –ø—Ä–∏–∑–Ω–∞–∫–µ, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ª–∏—á–∞–µ—Ç –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –∫–ª–∞—Å—Ç–µ—Ä—ã

### üìå –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç –æ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ó–∞–¥–∞–Ω–∏—è—Ö
